---
title: "tim_practice"
output: html_document
date: "2023-03-02"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
library(shiny)
library(ggplot2)
library(paletteer)
```

```{r}
getwd()
```

```{r}
avocado <- read_csv("avocado-updated-2020 2.csv")
```

```{r}
avocado 
```

```{r}
avocado %>% 
  select("year", "geography", "average_price") %>% 
  arrange(desc(average_price))
```
```{r}
organic_avocado %>% 
  arrange((average_price)) %>% 
  ggplot(aes(x=geography, y=average_price, fill=year))+ 
  geom_boxplot(alpha=0.4)+ 
  facet_grid(year~.)+
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```
##FINDING THE PRICE EXTREMITIES BY YEAR

```{r}
organic_avocado %>%  
  select("year", "geography", "average_price", "date") %>%
  filter(year==2020) %>% 
  arrange(desc(average_price)) %>% 
  slice_max(average_price, n= 3)
```

```{r}
organic_avocado %>%  
  select("year", "geography", "average_price", "date") %>%
  filter(year==2020) %>% 
  arrange(desc(average_price)) %>% 
  slice_min(average_price, n= 3)
```

```{r}
organic_avocado_date <-
  organic_avocado %>% 
    mutate("date" = as.factor(date))
```


```{r}
#PRICE EXTREMITIES FOR 2015
organic_avocado_date %>% 
  select("year", "geography", "average_price", "date") %>%
  filter(year==2015) %>% 
  filter(average_price <= 0.87 | average_price >= 2.77) %>% 
  arrange(desc(average_price)) %>% 
  ggplot(aes(x = reorder(date, +average_price), y=average_price, fill=geography, label=average_price)) +
    geom_col(position = "dodge") +
    geom_label() +
  labs(x= "Date of Observation", y = "Average Price")
```

```{r}
#PRICE EXTREMITIES FOR 2016
organic_avocado_date %>% 
  select("year", "geography", "average_price", "date") %>%
  filter(year==2016) %>% 
  filter(average_price <= 0.66 | average_price >= 3.03) %>% 
  arrange(desc(average_price)) %>% 
  ggplot(aes(x = date, y=average_price, fill=geography, position = "dodge")) +
    geom_col()

```

```{r}
#PRICE EXTREMITIES FOR 2017
organic_avocado %>% 
  select("year", "geography", "average_price", "date") %>%
  filter(year==2017) %>% 
  filter(average_price <= 0.49 | average_price >= 3.04) %>% 
  arrange(desc(average_price))
```

```{r}
#PRICE EXTREMITIES FOR 2018
organic_avocado %>% 
  select("year", "geography", "average_price", "date") %>%
  filter(year==2018) %>% 
  filter(average_price <= 0.75 | average_price >= 2.60) %>% 
  arrange(desc(average_price))
```

```{r}
#PRICE EXTREMITIES FOR 2019
organic_avocado %>% 
  select("year", "geography", "average_price", "date") %>%
  filter(year==2019) %>% 
  filter(average_price <= 0.79 | average_price >= 2.72) %>% 
  arrange(desc(average_price))
```

```{r}
#PRICE EXTREMITIES FOR 2020
organic_avocado %>% 
  select("year", "geography", "average_price", "date") %>%
  filter(year==2020) %>% 
  filter(average_price <= 0.85 | average_price >= 2.28) %>% 
  arrange(desc(average_price))
```



```{r}
organic_avocado %>% 
  arrange(desc(average_price))                  
```


```{r}
names(avocado)
#4046 = non-organic small/medium Hass Avocados (3-5 oz)  
#4225 = non-organic large Hass Avocados (8-10 oz)
#4770 = non-organic extra large Hass Avocados (10-15 oz)
```

```{r}
organic_avocado <- avocado %>% 
                      filter(type == "organic")
```

```{r}
normie_avocado <- avocado %>% 
                      filter(type == "conventional")
```

```{r}
avocado %>% 
  tabyl(geography)
```

```{r}

```

