labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5))
}
ggplotRegression <- function(fit){
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))
}
ggplotRegression(lm(average_price ~ time_dif, data = sf_data))
ggplotRegression <- function(fit){
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
#  stat_smooth(method = "lm", col = "red") +
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))
}
ggplotRegression(lm(average_price ~ time_dif, data = sf_data))
ggplotRegression <- function(fit){
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
#  geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))
}
ggplotRegression(lm(average_price ~ time_dif, data = sf_data))
ggplotRegression <- function(fit){
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))+
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)
}
ggplotRegression(lm(average_price ~ time_dif, data = sf_data))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))
ggplotRegression <- function(fit){
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))
}
ggplotRegression(lm(average_price ~ time_dif, data = sf_data))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =1.7728",
" Slope = -0.000011943")
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =1.7728",
"Slope = -0.000011943"))
sf_data <- sf_data %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
sf_data <- sf_data %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
sf_data
knitr::opts_chunk$set(echo = TRUE)
chic_data <- avo %>%
filter(geography == "Chicago")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
library(ggplot2)
install.packages("stargazer")
library(stargazer)
#install.packages("sandwich")
#install.packages("haven")
library(sandwich)
library(haven)
#setwd("emlieu_breakfast_price")
#setwd("/Users/eclieu/Desktop/emlieu_breakfast_price")
#setwd("/Users/eclieu/Desktop/BIS15W2023_elieu/")
#setwd("/Users/eclieu/Desktop/emlieu_breakfast_price/")
#getwd()
avo <- read_csv("avocado-updated-2020 2.csv")
avo
org_avo <- avo %>%
filter (type == "organic") %>%
arrange(desc(average_price))
org_avo
pleb_avo <- avo %>%
filter(type == "conventional") %>%
arrange(desc(average_price))
pleb_avo
avo %>%
select("year", "geography", "average_price") %>%
arrange(desc(average_price))
avo %>%
select("year", "geography", "average_price") %>%
arrange(average_price)
pleb_avo %>%
select("year", "geography", "average_price") %>%
arrange(desc(average_price))
pleb_avo %>%
select("year", "geography", "average_price") %>%
arrange(average_price)
org_avo %>%
select("year", "geography", "average_price") %>%
arrange(desc(average_price))
org_avo %>%
select("year", "geography", "average_price") %>%
arrange(average_price)
avo$year <- as.factor(avo$year)
avo
sf_data <- avo %>%
filter(geography == "San Francisco")
sf_data
sf_data <- sf_data %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
sf_data
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
stat_smooth(method= lm, se= F)
fit <- lm(`date` ~ average_price, `data` = sf_data)
ggplotRegression(fit)
chic_data <- avo %>%
filter(geography == "Chicago")
chic_data
chic_data <- avo %>%
filter(geography == "Chicago") %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
chic_data
ggplotRegression(lm(average_price ~ time_dif, data = chic_data))
ggplotRegression <- function(fit){
ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) +
geom_point() +
stat_smooth(method = "lm", col = "red") +
labs(title = paste("Intercept =",signif(fit$coef[[1]],5 ),
" Slope =",signif(fit$coef[[2]], 5)))
}
ggplotRegression(lm(average_price ~ time_dif, data = sf_data))
ggplotRegression(lm(average_price ~ time_dif, data = chic_data))
options(scipen= 999)
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =1.5219",
"Slope = -0.000011943"))
ggplotRegression(lm(average_price ~ time_dif, data = chic_data))
cinday_data <- avo %>%
filter(geography == "Cincinnati/Dayton")
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
cinday_data <- avo %>%
filter(geography == "Cincinnati/Dayton") %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
cinday_data <- avo %>%
filter(geography == "Cincinnati/Dayton") %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
cinday_data
ggplotRegression(lm(average_price ~ time_dif, data = cinday_data))
cinday_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =1.1692",
"Slope = 0.000064"))
photuc_data <- avo %>%
filter(geography == "Phoenix/Tucson") %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
photuc_data
ggplotRegression(lm(average_price ~ time_dif, data = photuc_data))
photuc_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method=lm, se=F)+
labs(title = paste("Intercept =1.2015",
"Slope = 0.000007"))
sac_data
sac_data <- avo %>%
filter(geography == "Sacramento")
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
sac_data <- avo %>%
filter(geography == "Sacramento") %>%
mutate(time_dif = as.double(difftime(date, lubridate::ymd("2015-01-04")), units= "days"))
sac_data
ggplotRegression(lm(average_price ~ time_dif, data = sac_data))
sac_data%>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method=lm, se=F)+
labs(title = paste("Intercept =1.5901",
"Slope = -0.000005"))
install.packages("RColorBrewer")
install.packages("paletteer")
install.packages("ggthemes")
install.packages("extrafont")
library(RColorBrewer)
library(paletteer)
library(ggthemes)
library(extrafont)
library(RColorBrewer)
library(paletteer)
library(ggthemes)
library(extrafont)
font_import()
loadfonts(device = "win")
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = "Avo Prices in Sf", paste("Intercept =1.7728",
"Slope = -0.000011943"))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = "Avo Prices in Sf; Intercept =1.7728, Slope = -0.000011943")
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943")
knitr::opts_chunk$set(echo = TRUE)
#PRICE EXTREMITIES FOR 2015
organic_avocado_date %>%
select("year", "Geography", "average_price", "date") %>%
filter(year==2015) %>%
filter(average_price <= 0.87 | average_price >= 2.77) %>%
arrange(desc(average_price)) %>%
ggplot(aes(x = reorder(date, +average_price),
y=average_price,
fill= Geography,
label=average_price)) +
geom_col(position = "dodge", alpha = 0.5, color = "black") +
scale_fill_brewer(palette = "Greens") +
geom_label(fill = "palegreen2") +
theme_grey(base_size = 14) +
theme(legend.background = element_rect(fill="lightgrey",
size=0.5, linetype="solid",
colour ="black")) +
labs(title="Organic Avocado Price Extremities in 2015",
x= "Date of Observation",
y = "Average Price") +
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(fill = "palegreen2")+
geom_smooth(method= lm, se= F)+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
scale_fill_brewer(palette = "Greens")+
geom_point(fill = "palegreen2")+
geom_smooth(method= lm, se= F)+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_smooth(method= lm, se= F)+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F, fill= "palegreen")+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F, color= "palegreen")+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen")+
geom_smooth(method= lm, se= F, color= "brown")+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
grDevices::colors()
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000011943",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =1.5219",
"Slope = 0.000002"))
cinday_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = paste("Intercept =1.1692",
"Slope = 0.000064"))
photuc_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method=lm, se=F)+
labs(title = paste("Intercept =1.2015",
"Slope = 0.000007"))
sac_data%>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method=lm, se=F)+
labs(title = paste("Intercept =1.5901",
"Slope = -0.000005"))
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Chicago Price Per Avo; Intercept =1.5219, Slope = 0.000002",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point()+
geom_smooth(method= lm, se= F)+
labs(title = "Chicago Price Per Avo; Intercept =1.5219, Slope = 0.000",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Chicago Price Per Avo; Intercept =1.5219, Slope = 0.000002",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
cinday_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Cincinnati/Dayton Price Per Avo; Intercept = 1.1692, Slope = 0.000064",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
cinday_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Cincinnati/Dayton Price Per Avo; Intercept = 1.1692, Slope = 0.000064",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=11, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Chicago Price Per Avo; Intercept =1.5219, Slope = 0.000002",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=11, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
photuc_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Phoeniz/Tucson Price Per Avo; Intercept = 1.2015, Slope = 0.000007",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=11, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
chic_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Chicago Price Per Avo; Intercept = 1.5219, Slope = 0.000002",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=11, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
sac_data%>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Sacramento Price Per Avo; Intercept = 1.5901, Slope = -0.000005",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=11, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(naniar)
library(ggplot2)
install.packages("RColorBrewer")
install.packages("paletteer")
install.packages("ggthemes")
install.packages("extrafont")
library(RColorBrewer)
library(paletteer)
library(ggthemes)
library(extrafont)
#setwd("emlieu_breakfast_price")
#setwd("/Users/eclieu/Desktop/emlieu_breakfast_price")
#setwd("/Users/eclieu/Desktop/BIS15W2023_elieu/")
#setwd("/Users/eclieu/Desktop/emlieu_breakfast_price/")
#getwd()
avo <- read_csv("avocado-updated-2020 2.csv")
avo
org_avo <- avo %>%
filter (type == "organic") %>%
arrange(desc(average_price))
org_avo
pleb_avo <- avo %>%
filter(type == "conventional") %>%
arrange(desc(average_price))
pleb_avo
avo %>%
select("year", "geography", "average_price") %>%
arrange(desc(average_price))
avo %>%
select("year", "geography", "average_price") %>%
arrange(average_price)
pleb_avo %>%
select("year", "geography", "average_price") %>%
arrange(desc(average_price))
pleb_avo %>%
select("year", "geography", "average_price") %>%
arrange(average_price)
org_avo %>%
select("year", "geography", "average_price") %>%
arrange(desc(average_price))
org_avo %>%
select("year", "geography", "average_price") %>%
arrange(average_price)
install.packages("ggthemes")
install.packages("RColorBrewer")
avo %>%
select("year", "geography", "average_price", "type") %>%
arrange(desc(average_price))
avo %>%
select("year", "geography", "average_price", "type") %>%
arrange(average_price)
sf_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Sf Price Per Avo; Intercept =1.7728, Slope = -0.000012",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=13, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
photuc_data %>%
ggplot(aes(x= date, y= average_price))+
geom_point(color= "palegreen4")+
geom_smooth(method= lm, se= F, color= "burlywood4")+
labs(title = "Phoenix/Tucson Price Per Avo; Intercept = 1.2015, Slope = 0.000007",
x= "Date",
y= "Average Price")+
theme(text=element_text(size=11, family="Comic Sans MS"),
axis.text.x = element_text(angle = 60, hjust=1))
